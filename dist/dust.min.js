!function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.core",[],t):"object"==typeof exports?module.exports=t():e.dust=t()}(this,function(){function getTemplate(e,t){return e?"function"==typeof e&&e.template?e.template:dust.isTemplateFn(e)?e:t!==!1?dust.cache[e]:void 0:void 0}function load(e,t,r){if(!e)return t.setError(new Error("No template or template name provided to render"));var n=getTemplate(e,dust.config.cache);return n?n(t,Context.wrap(r,n.templateName)):dust.onLoad?t.map(function(t){function n(e,n){var i;if(e)return t.setError(e);if(i=getTemplate(n,!1)||getTemplate(o,dust.config.cache),!i){if(!dust.compile)return t.setError(new Error("Dust compiler not available"));i=dust.loadSource(dust.compile(n,o))}i(t,Context.wrap(r,i.templateName)).end()}var o=e;3===dust.onLoad.length?dust.onLoad(o,r.options,n):dust.onLoad(o,n)}):t.setError(new Error("Template Not Found: "+e))}function Context(e,t,r,n,o){void 0===e||e instanceof Stack||(e=new Stack(e)),this.stack=e,this.global=t,this.options=r,this.blocks=n,this.templateName=o}function getWithResolvedData(e,t,r){return function(n){return e.push(n)._get(t,r)}}function Stack(e,t,r,n){this.tail=t,this.isObject=e&&"object"==typeof e,this.head=e,this.index=r,this.of=n}function Stub(e){this.head=new Chunk(this),this.callback=e,this.out=""}function Stream(){this.head=new Chunk(this)}function StackIndex(e){this.stack=e,this.index=null}function Chunk(e,t,r){this.root=e,this.next=t,this.data=[],this.flushable=!1,this.taps=r}function Tap(e,t){this.head=e,this.tail=t}var dust={version:"2.7.2"},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",EMPTY_FUNC=function(){};dust.config={whitespace:!1,amd:!1,cjs:!1,cache:!0},dust._aliases={write:"w",end:"e",map:"m",render:"r",reference:"f",section:"s",exists:"x",notexists:"nx",block:"b",partial:"p",helper:"h"},function(){var e,t,r={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};"undefined"!=typeof console&&console.log?(e=console.log,t="function"==typeof e?function(){e.apply(console,arguments)}:function(){e(Array.prototype.slice.apply(arguments).join(" "))}):t=EMPTY_FUNC,dust.log=function(e,n){n=n||INFO,r[n]>=r[dust.debugLevel]&&(t("[DUST:"+n+"]",e),n===ERROR&&dust.debugLevel===DEBUG&&e instanceof Error&&e.stack&&t("[DUST:"+n+"]",e.stack))},dust.debugLevel=NONE,"undefined"!=typeof process&&process.env&&/\bdust\b/.test(process.env.DEBUG)&&(dust.debugLevel=DEBUG)}(),dust.helpers={},dust.cache={},dust.register=function(e,t){e&&(t.templateName=e,dust.config.cache!==!1&&(dust.cache[e]=t))},dust.render=function(e,t,r){var n=new Stub(r).head;try{load(e,n,t).end()}catch(o){n.setError(o)}},dust.stream=function(e,t){var r=new Stream,n=r.head;return dust.nextTick(function(){try{load(e,n,t).end()}catch(r){n.setError(r)}}),r},dust.loadSource=function(source){return eval(source)},Array.isArray?dust.isArray=Array.isArray:dust.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},dust.nextTick=function(){return function(e){setTimeout(e,0)}}(),dust.isEmpty=function(e){return 0===e?!1:dust.isArray(e)&&!e.length?!0:!e},dust.isEmptyObject=function(e){var t;if(null===e)return!1;if(void 0===e)return!1;if(e.length>0)return!1;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},dust.isTemplateFn=function(e){return"function"==typeof e&&e.__dustBody},dust.isThenable=function(e){return e&&"object"==typeof e&&"function"==typeof e.then},dust.isStreamable=function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pipe},dust.filter=function(e,t,r,n){var o,i,u,s;if(r)for(o=0,i=r.length;i>o;o++)u=r[o],u.length&&(s=dust.filters[u],"s"===u?t=null:"function"==typeof s?e=s(e,n):dust.log("Invalid filter `"+u+"`",WARN));return t&&(e=dust.filters[t](e,n)),e},dust.filters={h:function(e){return dust.escapeHtml(e)},j:function(e){return dust.escapeJs(e)},u:encodeURI,uc:encodeURIComponent,js:function(e){return dust.escapeJSON(e)},jp:function(e){return JSON?JSON.parse(e):(dust.log("JSON is undefined; could not parse `"+e+"`",WARN),e)}},dust.makeBase=dust.context=function(e,t){return new Context(void 0,e,t)},Context.wrap=function(e,t){return e instanceof Context?(e.templateName=t,e):new Context(e,{},{},null,t)},Context.prototype.get=function(e,t){return"string"==typeof e&&("."===e[0]&&(t=!0,e=e.substr(1)),e=e.split(".")),this._get(t,e)},Context.prototype._get=function(e,t){var r,n,o,i,u,s=this.stack||{},c=1;if(n=t[0],o=t.length,e&&0===o)i=s,s=s.head;else{if(e)s&&(s=s.head?s.head[n]:void 0);else{for(;s&&(!s.isObject||(i=s.head,r=s.head[n],void 0===r));)s=s.tail;s=void 0!==r?r:this.global&&this.global[n]}for(;s&&o>c;){if(dust.isThenable(s))return s.then(getWithResolvedData(this,e,t.slice(c)));i=s,s=s[t[c]],c++}}return"function"==typeof s?(u=function(){try{return s.apply(i,arguments)}catch(e){throw dust.log(e,ERROR),e}},u.__dustBody=!!s.__dustBody,u):(void 0===s&&dust.log("Cannot find reference `{"+t.join(".")+"}` in template `"+this.getTemplateName()+"`",INFO),s)},Context.prototype.getPath=function(e,t){return this._get(e,t)},Context.prototype.push=function(e,t,r){return void 0===e?(dust.log("Not pushing an undefined variable onto the context",INFO),this):this.rebase(new Stack(e,this.stack,t,r))},Context.prototype.pop=function(){var e=this.current();return this.stack=this.stack&&this.stack.tail,e},Context.prototype.rebase=function(e){return new Context(e,this.global,this.options,this.blocks,this.getTemplateName())},Context.prototype.clone=function(){var e=this.rebase();return e.stack=this.stack,e},Context.prototype.current=function(){return this.stack&&this.stack.head},Context.prototype.getBlock=function(e){var t,r,n;if("function"==typeof e&&(e=e(new Chunk,this).data.join("")),t=this.blocks,!t)return dust.log("No blocks for context `"+e+"` in template `"+this.getTemplateName()+"`",DEBUG),!1;for(r=t.length;r--;)if(n=t[r][e])return n;return dust.log("Malformed template `"+this.getTemplateName()+"` was missing one or more blocks."),!1},Context.prototype.shiftBlocks=function(e){var t,r=this.blocks;return e?(t=r?r.concat([e]):[e],new Context(this.stack,this.global,this.options,t,this.getTemplateName())):this},Context.prototype.resolve=function(e){var t;return"function"!=typeof e?e:(t=(new Chunk).render(e,this),t instanceof Chunk?t.data.join(""):t)},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable)return e.error?(this.callback(e.error),dust.log("Rendering failed with error `"+e.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.out+=e.data.join(""),e=e.next,this.head=e}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable)return e.error?(this.emit("error",e.error),this.emit("end"),dust.log("Streaming failed with error `"+e.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",e.data.join("")),e=e.next,this.head=e}this.emit("end")},Stream.prototype.emit=function(e,t){var r,n,o=this.events||{},i=o[e]||[];if(!i.length)return dust.log("Stream broadcasting, but no listeners for `"+e+"`",DEBUG),!1;for(i=i.slice(0),r=0,n=i.length;n>r;r++)i[r](t);return!0},Stream.prototype.on=function(e,t){var r=this.events=this.events||{},n=r[e]=r[e]||[];return"function"!=typeof t?dust.log("No callback function provided for `"+e+"` event listener",WARN):n.push(t),this},Stream.prototype.pipe=function(e){if("function"!=typeof e.write||"function"!=typeof e.end)return dust.log("Incompatible stream passed to `pipe`",WARN),this;var t=!1;return"function"==typeof e.emit&&e.emit("pipe",this),"function"==typeof e.on&&e.on("error",function(){t=!0}),this.on("data",function(r){if(!t)try{e.write(r,"utf8")}catch(n){dust.log(n,ERROR)}}).on("end",function(){if(!t)try{e.end(),t=!0}catch(r){dust.log(r,ERROR)}})},StackIndex.prototype.indices=function(){var e=this.stack,t=[],r=function(e){for(var n in e)if(e.hasOwnProperty(n)&&"tail"===n&&"object"==typeof e[n]){var o=e[n],i=o.index;void 0!==i&&(t.push(i),r(o))}};if(void 0!==e.index){t.push(e.index),r(e);var n=t.length;t=t.reverse();for(var o=[],i=0;n>i;i++){var u={index:"$"+i.toString(),value:t[i]};o.push(u)}return this.index="$"+n.toString(),o}return null},Chunk.prototype.write=function(e){var t=this.taps;return t&&(e=t.go(e)),this.data.push(e),this},Chunk.prototype.end=function(e){return e&&this.write(e),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(e){var t=new Chunk(this.root,this.next,this.taps),r=new Chunk(this.root,t,this.taps);this.next=r,this.flushable=!0;try{e(r)}catch(n){dust.log(n,ERROR),r.setError(n)}return t},Chunk.prototype.tap=function(e){var t=this.taps;return t?this.taps=t.push(e):this.taps=new Tap(e),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(e,t){return e(this,t)},Chunk.prototype.reference=function(e,t,r,n){return"function"==typeof e?(e=e.apply(t.current(),[this,t,null,{auto:r,filters:n}]),e instanceof Chunk?e:this.reference(e,t,r,n)):dust.isThenable(e)?this.await(e,t,null,r,n):dust.isStreamable(e)?this.stream(e,t,null,r,n):dust.isEmpty(e)?this:this.write(dust.filter(e,r,n,t))},Chunk.prototype.section=function(e,t,r,n){var o,i,u,s=r.block,c=r["else"],a=this;if("function"==typeof e&&!dust.isTemplateFn(e)){try{e=e.apply(t.current(),[this,t,r,n])}catch(l){return dust.log(l,ERROR),this.setError(l)}if(e instanceof Chunk)return e}if(dust.isEmptyObject(r))return a;if(dust.isEmptyObject(n)||(t=t.push(n)),dust.isArray(e)){if(s){if(i=e.length,i>0){u=t.stack&&t.stack.head||{},u.$len=i;var f=new StackIndex(t.stack),p=f.indices(),d=f.index;if(p)for(var h=0;h<p.length;h++)u[p[h].index]=p[h].value;for(o=0;i>o;o++)u.$idx=o,d?u[d]=o:u.$0=o,a=s(a,t.push(e[o],o,i));return delete u.$idx,delete u.$len,d?(delete u[d],p&&p.forEach(function(e){delete u[e.index]})):u.$0&&delete u.$0,a}if(c)return c(this,t)}}else{if(dust.isThenable(e))return this.await(e,t,r);if(dust.isStreamable(e))return this.stream(e,t,r);if(e===!0){if(s)return s(this,t)}else if(e||0===e){if(s)return s(this,t.push(e))}else if(c)return c(this,t)}return dust.log("Section without corresponding key in template `"+t.getTemplateName()+"`",DEBUG),this},Chunk.prototype.exists=function(e,t,r){var n=r.block,o=r["else"];if(dust.isEmpty(e)){if(o)return o(this,t)}else{if(n)return n(this,t);dust.log("No block for exists check in template `"+t.getTemplateName()+"`",DEBUG)}return this},Chunk.prototype.notexists=function(e,t,r){var n=r.block,o=r["else"];if(dust.isEmpty(e)){if(n)return n(this,t);dust.log("No block for not-exists check in template `"+t.getTemplateName()+"`",DEBUG)}else if(o)return o(this,t);return this},Chunk.prototype.block=function(e,t,r){var n=e||r.block;return n?n(this,t):this},Chunk.prototype.partial=function(e,t,r,n){var o;return void 0===n&&(n=r,r=t),dust.isEmptyObject(n)||(r=r.clone(),o=r.pop(),r=r.push(n).push(o)),dust.isTemplateFn(e)?this.capture(e,t,function(e,t){load(e,t,r).end()}):load(e,this,r)},Chunk.prototype.helper=function(e,t,r,n,o){var i,u=this,s=n.filters;if(void 0===o&&(o="h"),!dust.helpers[e])return dust.log("Helper `"+e+"` does not exist",WARN),u;try{return i=dust.helpers[e](u,t,r,n),i instanceof Chunk?i:("string"==typeof s&&(s=s.split("|")),dust.isEmptyObject(r)?u.reference(i,t,o,s):u.section(i,t,r,n))}catch(c){return dust.log("Error in helper `"+e+"`: "+c.message,ERROR),u.setError(c)}},Chunk.prototype.await=function(e,t,r,n,o){return this.map(function(i){e.then(function(e){i=r?i.section(e,t,r):i.reference(e,t,n,o),i.end()},function(e){var n=r&&r.error;n?i.render(n,t.push(e)).end():(dust.log("Unhandled promise rejection in `"+t.getTemplateName()+"`",INFO),i.end())})})},Chunk.prototype.stream=function(e,t,r,n,o){var i=r&&r.block,u=r&&r.error;return this.map(function(s){var c=!1;e.on("data",function(e){c||(i?s=s.map(function(r){r.render(i,t.push(e)).end()}):r||(s=s.reference(e,t,n,o)))}).on("error",function(e){c||(u?s.render(u,t.push(e)):dust.log("Unhandled stream error in `"+t.getTemplateName()+"`",INFO),c||(c=!0,s.end()))}).on("end",function(){c||(c=!0,s.end())})})},Chunk.prototype.capture=function(e,t,r){return this.map(function(n){var o=new Stub(function(e,t){e?n.setError(e):r(t,n)});e(o.head,t).end()})},Chunk.prototype.setError=function(e){return this.error=e,this.root.flush(),this};for(var f in Chunk.prototype)dust._aliases[f]&&(Chunk.prototype[dust._aliases[f]]=Chunk.prototype[f]);Tap.prototype.push=function(e){return new Tap(e,this)},Tap.prototype.go=function(e){for(var t=this;t;)e=t.head(e),t=t.tail;return e};var HCHARS=/[&<>"']/,AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(e){return"string"==typeof e||e&&"function"==typeof e.toString?("string"!=typeof e&&(e=e.toString()),HCHARS.test(e)?e.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):e):e};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;return dust.escapeJs=function(e){return"string"==typeof e?e.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):e},dust.escapeJSON=function(e){return JSON?JSON.stringify(e).replace(LS,"\\u2028").replace(PS,"\\u2029").replace(LT,"\\u003c"):(dust.log("JSON is undefined; could not escape `"+e+"`",WARN),e)},dust}),function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.parse",["dust.core"],function(e){return t(e).parse}):"object"==typeof exports?module.exports=t(require("./dust")):t(e.dust)}(this,function(e){var t=function(){"use strict";function e(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}function t(e,r,n,o){this.message=e,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}function r(e){function r(){return i(br,gr)}function n(t){throw s(t,null,e.substring(br,gr),i(br,gr))}function o(t){var r,n,o=kr[t];if(o)return o;for(r=t-1;!kr[r];)r--;for(o=kr[r],o={line:o.line,column:o.column,seenCR:o.seenCR};t>r;)n=e.charAt(r),"\n"===n?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),r++;return kr[t]=o,o}function i(e,t){var r=o(e),n=o(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function u(e){xr>gr||(gr>xr&&(xr=gr,Nr=[]),Nr.push(e))}function s(e,r,n,o){function i(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function u(e,t){function r(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var n,o,i,u=new Array(e.length);for(i=0;i<e.length;i++)u[i]=e[i].description;return n=e.length>1?u.slice(0,-1).join(", ")+" or "+u[e.length-1]:u[0],o=t?'"'+r(t)+'"':"end of input","Expected "+n+" but "+o+" found."}return null!==r&&i(r),new t(null!==e?e:u(r,n),r,n,o)}function c(){var e;return e=a()}function a(){var e,t,r;for(e=gr,t=[],r=l();r!==Z;)t.push(r),r=l();return t!==Z&&(br=e,t=V(t)),e=t}function l(){var e;return e=U(),e===Z&&(e=P(),e===Z&&(e=f(),e===Z&&(e=g(),e===Z&&(e=k(),e===Z&&(e=y(),e===Z&&(e=_())))))),e}function f(){var t,r,n,o,i,s,c,l;if(Cr++,t=gr,r=p(),r!==Z){for(n=[],o=G();o!==Z;)n.push(o),o=G();n!==Z?(o=W(),o!==Z?(i=a(),i!==Z?(s=v(),s!==Z?(c=d(),c===Z&&(c=null),c!==Z?(br=gr,l=ee(r,i,s,c),l=l?void 0:Z,l!==Z?(br=t,r=te(r,i,s,c),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;if(t===Z)if(t=gr,r=p(),r!==Z){for(n=[],o=G();o!==Z;)n.push(o),o=G();n!==Z?(47===e.charCodeAt(gr)?(o=re,gr++):(o=Z,0===Cr&&u(ne)),o!==Z?(i=W(),i!==Z?(br=t,r=oe(r),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(X)),t}function p(){var t,r,n,o,i,s,c;if(t=gr,r=I(),r!==Z)if(ie.test(e.charAt(gr))?(n=e.charAt(gr),gr++):(n=Z,0===Cr&&u(ue)),n!==Z){for(o=[],i=G();i!==Z;)o.push(i),i=G();o!==Z?(i=x(),i!==Z?(s=h(),s!==Z?(c=m(),c!==Z?(br=t,r=se(n,i,s,c),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;else gr=t,t=Z;return t}function d(){var t,r,n,o,i,s,c;if(Cr++,t=gr,r=I(),r!==Z)if(47===e.charCodeAt(gr)?(n=re,gr++):(n=Z,0===Cr&&u(ne)),n!==Z){for(o=[],i=G();i!==Z;)o.push(i),i=G();if(o!==Z)if(i=x(),i!==Z){for(s=[],c=G();c!==Z;)s.push(c),c=G();s!==Z?(c=W(),c!==Z?(br=t,r=ae(i),t=r):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;else gr=t,t=Z}else gr=t,t=Z;else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(ce)),t}function h(){var t,r,n,o;return t=gr,r=gr,58===e.charCodeAt(gr)?(n=le,gr++):(n=Z,0===Cr&&u(fe)),n!==Z?(o=x(),o!==Z?(br=r,n=pe(o),r=n):(gr=r,r=Z)):(gr=r,r=Z),r===Z&&(r=null),r!==Z&&(br=t,r=de(r)),t=r}function m(){var t,r,n,o,i,s,c;if(Cr++,t=gr,r=[],n=gr,o=[],i=G(),i!==Z)for(;i!==Z;)o.push(i),i=G();else o=Z;for(o!==Z?(i=S(),i!==Z?(61===e.charCodeAt(gr)?(s=me,gr++):(s=Z,0===Cr&&u(ve)),s!==Z?(c=N(),c===Z&&(c=x(),c===Z&&(c=T())),c!==Z?(br=n,o=ye(i,c),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z);n!==Z;){if(r.push(n),n=gr,o=[],i=G(),i!==Z)for(;i!==Z;)o.push(i),i=G();else o=Z;o!==Z?(i=S(),i!==Z?(61===e.charCodeAt(gr)?(s=me,gr++):(s=Z,0===Cr&&u(ve)),s!==Z?(c=N(),c===Z&&(c=x(),c===Z&&(c=T())),c!==Z?(br=n,o=ye(i,c),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)}return r!==Z&&(br=t,r=ge(r)),t=r,Cr--,t===Z&&(r=Z,0===Cr&&u(he)),t}function v(){var t,r,n,o,i,s,c,l;for(Cr++,t=gr,r=[],n=gr,o=I(),o!==Z?(58===e.charCodeAt(gr)?(i=le,gr++):(i=Z,0===Cr&&u(fe)),i!==Z?(s=S(),s!==Z?(c=W(),c!==Z?(l=a(),l!==Z?(br=n,o=ye(s,l),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z);n!==Z;)r.push(n),n=gr,o=I(),o!==Z?(58===e.charCodeAt(gr)?(i=le,gr++):(i=Z,0===Cr&&u(fe)),i!==Z?(s=S(),s!==Z?(c=W(),c!==Z?(l=a(),l!==Z?(br=n,o=ye(s,l),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z);return r!==Z&&(br=t,r=ke(r)),t=r,Cr--,t===Z&&(r=Z,0===Cr&&u(be)),t}function y(){var e,t,r,n,o;return Cr++,e=gr,t=I(),t!==Z?(r=x(),r!==Z?(n=b(),n!==Z?(o=W(),o!==Z?(br=e,t=Ne(r,n),e=t):(gr=e,e=Z)):(gr=e,e=Z)):(gr=e,e=Z)):(gr=e,e=Z),Cr--,e===Z&&(t=Z,0===Cr&&u(xe)),e}function g(){var t,r,n,o,i,s,c,a,l,f;if(Cr++,t=gr,r=I(),r!==Z)if(62===e.charCodeAt(gr)?(n=Ae,gr++):(n=Z,0===Cr&&u(Re)),n===Z&&(43===e.charCodeAt(gr)?(n=we,gr++):(n=Z,0===Cr&&u(Ee))),n!==Z){for(o=[],i=G();i!==Z;)o.push(i),i=G();if(o!==Z)if(i=gr,s=S(),s!==Z&&(br=i,s=Se(n,s)),i=s,i===Z&&(i=T()),i!==Z)if(s=h(),s!==Z)if(c=m(),c!==Z){for(a=[],l=G();l!==Z;)a.push(l),l=G();a!==Z?(47===e.charCodeAt(gr)?(l=re,gr++):(l=Z,0===Cr&&u(ne)),l!==Z?(f=W(),f!==Z?(br=t,r=Oe(n,i,s,c),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;else gr=t,t=Z;else gr=t,t=Z;else gr=t,t=Z}else gr=t,t=Z;else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(Ce)),t}function b(){var t,r,n,o,i;for(Cr++,t=gr,r=[],n=gr,124===e.charCodeAt(gr)?(o=Te,gr++):(o=Z,0===Cr&&u(Fe)),o!==Z?(i=S(),i!==Z?(br=n,o=pe(i),n=o):(gr=n,n=Z)):(gr=n,n=Z);n!==Z;)r.push(n),n=gr,124===e.charCodeAt(gr)?(o=Te,gr++):(o=Z,0===Cr&&u(Fe)),o!==Z?(i=S(),i!==Z?(br=n,o=pe(i),n=o):(gr=n,n=Z)):(gr=n,n=Z);return r!==Z&&(br=t,r=_e(r)),t=r,Cr--,t===Z&&(r=Z,0===Cr&&u(je)),t}function k(){var t,r,n,o,i;return Cr++,t=gr,r=I(),r!==Z?(126===e.charCodeAt(gr)?(n=Be,gr++):(n=Z,0===Cr&&u(Ue)),n!==Z?(o=S(),o!==Z?(i=W(),i!==Z?(br=t,r=Pe(o),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z),Cr--,t===Z&&(r=Z,0===Cr&&u(De)),t}function x(){var e,t;return Cr++,e=gr,t=E(),t!==Z&&(br=e,t=Ie(t)),e=t,e===Z&&(e=gr,t=S(),t!==Z&&(br=e,t=We(t)),e=t),Cr--,e===Z&&(t=Z,0===Cr&&u(Le)),e}function N(){var e,t;return Cr++,e=gr,t=C(),t===Z&&(t=w()),t!==Z&&(br=e,t=Me(t)),e=t,Cr--,e===Z&&(t=Z,0===Cr&&u($e)),e}function C(){var t,r,n,o;return Cr++,t=gr,r=w(),r!==Z?(46===e.charCodeAt(gr)?(n=Ge,gr++):(n=Z,0===Cr&&u(ze)),n!==Z?(o=A(),o!==Z?(br=t,r=qe(r,o),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z),Cr--,t===Z&&(r=Z,0===Cr&&u(Je)),t}function A(){var t,r,n;if(Cr++,t=gr,r=[],He.test(e.charAt(gr))?(n=e.charAt(gr),gr++):(n=Z,0===Cr&&u(Ze)),n!==Z)for(;n!==Z;)r.push(n),He.test(e.charAt(gr))?(n=e.charAt(gr),gr++):(n=Z,0===Cr&&u(Ze));else r=Z;return r!==Z&&(br=t,r=Ye(r)),t=r,Cr--,t===Z&&(r=Z,0===Cr&&u(Qe)),t}function R(){var t,r,n;return Cr++,t=gr,45===e.charCodeAt(gr)?(r=Ve,gr++):(r=Z,0===Cr&&u(Xe)),r!==Z?(n=A(),n!==Z?(br=t,r=et(r,n),t=r):(gr=t,t=Z)):(gr=t,t=Z),Cr--,t===Z&&(r=Z,0===Cr&&u(Ke)),t}function w(){var e,t;return Cr++,e=R(),e===Z&&(e=A()),Cr--,e===Z&&(t=Z,0===Cr&&u(tt)),e}function E(){var t,r,n,o;if(Cr++,t=gr,r=S(),r===Z&&(r=null),r!==Z){if(n=[],o=j(),o===Z&&(o=O()),o!==Z)for(;o!==Z;)n.push(o),o=j(),o===Z&&(o=O());else n=Z;n!==Z?(br=t,r=nt(r,n),t=r):(gr=t,t=Z)}else gr=t,t=Z;if(t===Z)if(t=gr,46===e.charCodeAt(gr)?(r=Ge,gr++):(r=Z,0===Cr&&u(ze)),r!==Z){for(n=[],o=j(),o===Z&&(o=O());o!==Z;)n.push(o),o=j(),o===Z&&(o=O());n!==Z?(br=t,r=ot(n),t=r):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(rt)),t}function S(){var t,r,n,o;if(Cr++,t=gr,ut.test(e.charAt(gr))?(r=e.charAt(gr),gr++):(r=Z,0===Cr&&u(st)),r!==Z){for(n=[],ct.test(e.charAt(gr))?(o=e.charAt(gr),gr++):(o=Z,0===Cr&&u(at));o!==Z;)n.push(o),ct.test(e.charAt(gr))?(o=e.charAt(gr),gr++):(o=Z,0===Cr&&u(at));n!==Z?(br=t,r=lt(r,n),t=r):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(it)),t}function O(){var t,r,n,o,i,s;if(Cr++,t=gr,r=gr,n=$(),n!==Z){if(o=gr,i=[],He.test(e.charAt(gr))?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Ze)),s!==Z)for(;s!==Z;)i.push(s),He.test(e.charAt(gr))?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Ze));else i=Z;i!==Z&&(br=o,i=pt(i)),o=i,o===Z&&(o=x()),o!==Z?(i=M(),i!==Z?(br=r,n=dt(o),r=n):(gr=r,r=Z)):(gr=r,r=Z)}else gr=r,r=Z;return r!==Z?(n=j(),n===Z&&(n=null),n!==Z?(br=t,r=ht(r,n),t=r):(gr=t,t=Z)):(gr=t,t=Z),Cr--,t===Z&&(r=Z,0===Cr&&u(ft)),t}function j(){var t,r,n,o,i;if(Cr++,t=gr,r=[],n=gr,46===e.charCodeAt(gr)?(o=Ge,gr++):(o=Z,0===Cr&&u(ze)),o!==Z?(i=S(),i!==Z?(br=n,o=vt(i),n=o):(gr=n,n=Z)):(gr=n,n=Z),n!==Z)for(;n!==Z;)r.push(n),n=gr,46===e.charCodeAt(gr)?(o=Ge,gr++):(o=Z,0===Cr&&u(ze)),o!==Z?(i=S(),i!==Z?(br=n,o=vt(i),n=o):(gr=n,n=Z)):(gr=n,n=Z);else r=Z;return r!==Z?(n=O(),n===Z&&(n=null),n!==Z?(br=t,r=yt(r,n),t=r):(gr=t,t=Z)):(gr=t,t=Z),Cr--,t===Z&&(r=Z,0===Cr&&u(mt)),t}function T(){var t,r,n,o;if(Cr++,t=gr,34===e.charCodeAt(gr)?(r=bt,gr++):(r=Z,0===Cr&&u(kt)),r!==Z?(34===e.charCodeAt(gr)?(n=bt,gr++):(n=Z,0===Cr&&u(kt)),n!==Z?(br=t,r=xt(),t=r):(gr=t,t=Z)):(gr=t,t=Z),t===Z&&(t=gr,34===e.charCodeAt(gr)?(r=bt,gr++):(r=Z,0===Cr&&u(kt)),r!==Z?(n=D(),n!==Z?(34===e.charCodeAt(gr)?(o=bt,gr++):(o=Z,0===Cr&&u(kt)),o!==Z?(br=t,r=Nt(n),t=r):(gr=t,t=Z)):(gr=t,t=Z)):(gr=t,t=Z),t===Z))if(t=gr,34===e.charCodeAt(gr)?(r=bt,gr++):(r=Z,0===Cr&&u(kt)),r!==Z){if(n=[],o=F(),o!==Z)for(;o!==Z;)n.push(o),o=F();else n=Z;n!==Z?(34===e.charCodeAt(gr)?(o=bt,gr++):(o=Z,0===Cr&&u(kt)),o!==Z?(br=t,r=Ct(n),t=r):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(gt)),t}function F(){var e,t;return e=k(),e===Z&&(e=y(),e===Z&&(e=gr,t=D(),t!==Z&&(br=e,t=At(t)),e=t)),e}function _(){var t,r,n,o,i,s,c,a;if(Cr++,t=gr,r=J(),r!==Z){for(n=[],o=G();o!==Z;)n.push(o),o=G();n!==Z?(br=t,r=wt(r,n),t=r):(gr=t,t=Z)}else gr=t,t=Z;if(t===Z){if(t=gr,r=[],n=gr,o=gr,Cr++,i=L(),Cr--,i===Z?o=void 0:(gr=o,o=Z),o!==Z?(i=gr,Cr++,s=U(),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(s=gr,Cr++,c=P(),Cr--,c===Z?s=void 0:(gr=s,s=Z),s!==Z?(c=gr,Cr++,a=J(),Cr--,a===Z?c=void 0:(gr=c,c=Z),c!==Z?(e.length>gr?(a=e.charAt(gr),gr++):(a=Z,0===Cr&&u(Et)),a!==Z?(br=n,o=St(a),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z),n!==Z)for(;n!==Z;)r.push(n),n=gr,o=gr,Cr++,i=L(),Cr--,i===Z?o=void 0:(gr=o,o=Z),o!==Z?(i=gr,Cr++,s=U(),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(s=gr,Cr++,c=P(),Cr--,c===Z?s=void 0:(gr=s,s=Z),s!==Z?(c=gr,Cr++,a=J(),Cr--,a===Z?c=void 0:(gr=c,c=Z),c!==Z?(e.length>gr?(a=e.charAt(gr),gr++):(a=Z,0===Cr&&u(Et)),a!==Z?(br=n,o=St(a),n=o):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z)):(gr=n,n=Z);else r=Z;r!==Z&&(br=t,r=Ot(r)),t=r}return Cr--,t===Z&&(r=Z,0===Cr&&u(Rt)),t}function D(){var t,r,n,o,i;if(Cr++,t=gr,r=[],n=gr,o=gr,Cr++,i=L(),Cr--,i===Z?o=void 0:(gr=o,o=Z),o!==Z?(i=B(),i===Z&&(Tt.test(e.charAt(gr))?(i=e.charAt(gr),gr++):(i=Z,0===Cr&&u(Ft))),i!==Z?(br=n,o=St(i),n=o):(gr=n,n=Z)):(gr=n,n=Z),n!==Z)for(;n!==Z;)r.push(n),n=gr,o=gr,Cr++,i=L(),Cr--,i===Z?o=void 0:(gr=o,o=Z),o!==Z?(i=B(),i===Z&&(Tt.test(e.charAt(gr))?(i=e.charAt(gr),gr++):(i=Z,0===Cr&&u(Ft))),i!==Z?(br=n,o=St(i),n=o):(gr=n,n=Z)):(gr=n,n=Z);else r=Z;return r!==Z&&(br=t,r=_t(r)),t=r,Cr--,t===Z&&(r=Z,0===Cr&&u(jt)),t}function B(){var t,r;return t=gr,e.substr(gr,2)===Dt?(r=Dt,gr+=2):(r=Z,0===Cr&&u(Bt)),r!==Z&&(br=t,r=Ut()),t=r}function U(){var t,r,n,o,i,s;if(Cr++,t=gr,e.substr(gr,2)===Lt?(r=Lt,gr+=2):(r=Z,0===Cr&&u(It)),r!==Z){for(n=[],o=gr,i=gr,Cr++,e.substr(gr,2)===Wt?(s=Wt,gr+=2):(s=Z,0===Cr&&u($t)),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(e.length>gr?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Et)),s!==Z?(br=o,i=Mt(s),o=i):(gr=o,o=Z)):(gr=o,o=Z);o!==Z;)n.push(o),o=gr,i=gr,Cr++,e.substr(gr,2)===Wt?(s=Wt,gr+=2):(s=Z,0===Cr&&u($t)),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(e.length>gr?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Et)),s!==Z?(br=o,i=Mt(s),o=i):(gr=o,o=Z)):(gr=o,o=Z);n!==Z?(e.substr(gr,2)===Wt?(o=Wt,gr+=2):(o=Z,0===Cr&&u($t)),o!==Z?(br=t,r=Jt(n),t=r):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(Pt)),t}function P(){var t,r,n,o,i,s;if(Cr++,t=gr,e.substr(gr,2)===zt?(r=zt,gr+=2):(r=Z,0===Cr&&u(qt)),r!==Z){for(n=[],o=gr,i=gr,Cr++,e.substr(gr,2)===Qt?(s=Qt,gr+=2):(s=Z,0===Cr&&u(Ht)),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(e.length>gr?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Et)),s!==Z?(br=o,i=St(s),o=i):(gr=o,o=Z)):(gr=o,o=Z);o!==Z;)n.push(o),o=gr,i=gr,Cr++,e.substr(gr,2)===Qt?(s=Qt,gr+=2):(s=Z,0===Cr&&u(Ht)),Cr--,s===Z?i=void 0:(gr=i,i=Z),i!==Z?(e.length>gr?(s=e.charAt(gr),gr++):(s=Z,0===Cr&&u(Et)),s!==Z?(br=o,i=St(s),o=i):(gr=o,o=Z)):(gr=o,o=Z);n!==Z?(e.substr(gr,2)===Qt?(o=Qt,gr+=2):(o=Z,0===Cr&&u(Ht)),o!==Z?(br=t,r=Zt(n),t=r):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z;return Cr--,t===Z&&(r=Z,0===Cr&&u(Gt)),t}function L(){var t,r,n,o,i,s,c,a,l,f;if(t=gr,r=I(),r!==Z){for(n=[],o=G();o!==Z;)n.push(o),o=G();if(n!==Z)if(Yt.test(e.charAt(gr))?(o=e.charAt(gr),gr++):(o=Z,0===Cr&&u(Kt)),o!==Z){for(i=[],s=G();s!==Z;)i.push(s),s=G();if(i!==Z){if(s=[],c=gr,a=gr,Cr++,l=W(),Cr--,l===Z?a=void 0:(gr=a,a=Z),a!==Z?(l=gr,Cr++,f=J(),Cr--,f===Z?l=void 0:(gr=l,l=Z),l!==Z?(e.length>gr?(f=e.charAt(gr),gr++):(f=Z,0===Cr&&u(Et)),f!==Z?(a=[a,l,f],c=a):(gr=c,c=Z)):(gr=c,c=Z)):(gr=c,c=Z),c!==Z)for(;c!==Z;)s.push(c),c=gr,a=gr,Cr++,l=W(),Cr--,l===Z?a=void 0:(gr=a,a=Z),a!==Z?(l=gr,Cr++,f=J(),Cr--,f===Z?l=void 0:(gr=l,l=Z),l!==Z?(e.length>gr?(f=e.charAt(gr),gr++):(f=Z,0===Cr&&u(Et)),f!==Z?(a=[a,l,f],c=a):(gr=c,c=Z)):(gr=c,c=Z)):(gr=c,c=Z);else s=Z;if(s!==Z){for(c=[],a=G();a!==Z;)c.push(a),a=G();c!==Z?(a=W(),a!==Z?(r=[r,n,o,i,s,c,a],t=r):(gr=t,t=Z)):(gr=t,t=Z)}else gr=t,t=Z}else gr=t,t=Z}else gr=t,t=Z;else gr=t,t=Z}else gr=t,t=Z;return t===Z&&(t=y()),t}function I(){var t;return 123===e.charCodeAt(gr)?(t=Vt,gr++):(t=Z,0===Cr&&u(Xt)),t}function W(){var t;return 125===e.charCodeAt(gr)?(t=er,gr++):(t=Z,0===Cr&&u(tr)),t}function $(){var t;return 91===e.charCodeAt(gr)?(t=rr,gr++):(t=Z,0===Cr&&u(nr)),t}function M(){var t;return 93===e.charCodeAt(gr)?(t=or,gr++):(t=Z,0===Cr&&u(ir)),t}function J(){var t;return 10===e.charCodeAt(gr)?(t=ur,gr++):(t=Z,0===Cr&&u(sr)),t===Z&&(e.substr(gr,2)===cr?(t=cr,gr+=2):(t=Z,0===Cr&&u(ar)),t===Z&&(13===e.charCodeAt(gr)?(t=lr,gr++):(t=Z,0===Cr&&u(fr)),t===Z&&(8232===e.charCodeAt(gr)?(t=pr,gr++):(t=Z,0===Cr&&u(dr)),t===Z&&(8233===e.charCodeAt(gr)?(t=hr,gr++):(t=Z,0===Cr&&u(mr)))))),t}function G(){var t;return vr.test(e.charAt(gr))?(t=e.charAt(gr),gr++):(t=Z,0===Cr&&u(yr)),t===Z&&(t=J()),t}function z(e){return parseInt(e.join(""),10)}function q(e){return e.concat([["line",r().start.line],["col",r().start.column]])}var Q,H=arguments.length>1?arguments[1]:{},Z={},Y={start:c},K=c,V=function(e){var t=["body"].concat(e);return q(t)},X={type:"other",description:"section"},ee=function(e,t,r,o){return o&&e[1].text===o.text||n("Expected end tag for "+e[1].text+" but it was not found."),!0},te=function(e,t,r,n){return r.push(["param",["literal","block"],t]),e.push(r,["filters"]),q(e)},re="/",ne={type:"literal",value:"/",description:'"/"'},oe=function(e){return e.push(["bodies"],["filters"]),q(e)},ie=/^[#?\^<+@%]/,ue={type:"class",value:"[#?^<+@%]",description:"[#?^<+@%]"},se=function(e,t,r,n){return[e,t,r,n]},ce={type:"other",description:"end tag"},ae=function(e){return e},le=":",fe={type:"literal",value:":",description:'":"'},pe=function(e){return e},de=function(e){return e?["context",e]:["context"]},he={type:"other",description:"params"},me="=",ve={type:"literal",value:"=",description:'"="'},ye=function(e,t){return["param",["literal",e],t]},ge=function(e){return["params"].concat(e)},be={type:"other",description:"bodies"},ke=function(e){return["bodies"].concat(e)},xe={type:"other",description:"reference"},Ne=function(e,t){return q(["reference",e,t])},Ce={type:"other",description:"partial"},Ae=">",Re={type:"literal",value:">",description:'">"'},we="+",Ee={type:"literal",value:"+",description:'"+"'},Se=function(e,t){return["literal",t]},Oe=function(e,t,r,n){var o=">"===e?"partial":e;return q([o,t,r,n])},je={type:"other",description:"filters"},Te="|",Fe={type:"literal",value:"|",description:'"|"'},_e=function(e){return["filters"].concat(e)},De={type:"other",description:"special"},Be="~",Ue={type:"literal",value:"~",description:'"~"'},Pe=function(e){return q(["special",e])},Le={type:"other",description:"identifier"},Ie=function(e){var t=["path"].concat(e);return t.text=e[1].join(".").replace(/,line,\d+,col,\d+/g,""),t},We=function(e){var t=["key",e];return t.text=e,t},$e={type:"other",description:"number"},Me=function(e){return["literal",e]},Je={type:"other",description:"float"},Ge=".",ze={type:"literal",value:".",description:'"."'},qe=function(e,t){return parseFloat(e+"."+t)},Qe={type:"other",description:"unsigned_integer"},He=/^[0-9]/,Ze={type:"class",value:"[0-9]",description:"[0-9]"},Ye=function(e){return z(e)},Ke={type:"other",description:"signed_integer"},Ve="-",Xe={type:"literal",value:"-",description:'"-"'},et=function(e,t){return-1*t},tt={type:"other",description:"integer"},rt={type:"other",description:"path"},nt=function(e,t){return t=t[0],e&&t?(t.unshift(e),q([!1,t])):q([!0,t])},ot=function(e){return q(e.length>0?[!0,e[0]]:[!0,[]])},it={type:"other",description:"key"},ut=/^[a-zA-Z_$]/,st={type:"class",value:"[a-zA-Z_$]",description:"[a-zA-Z_$]"},ct=/^[0-9a-zA-Z_$\-]/,at={type:"class",value:"[0-9a-zA-Z_$-]",description:"[0-9a-zA-Z_$-]"},lt=function(e,t){return e+t.join("")},ft={type:"other",description:"array"},pt=function(e){return e.join("")},dt=function(e){return e},ht=function(e,t){return t?t.unshift(e):t=[e],t},mt={type:"other",description:"array_part"},vt=function(e){return e},yt=function(e,t){return t?e.concat(t):e},gt={type:"other",description:"inline"},bt='"',kt={type:"literal",value:'"',description:'"\\""'},xt=function(){return q(["literal",""])},Nt=function(e){return q(["literal",e])},Ct=function(e){return q(["body"].concat(e))},At=function(e){return["buffer",e]},Rt={type:"other",description:"buffer"},wt=function(e,t){return q(["format",e,t.join("")])},Et={type:"any",description:"any character"},St=function(e){return e},Ot=function(e){return q(["buffer",e.join("")])},jt={type:"other",description:"literal"},Tt=/^[^"]/,Ft={type:"class",value:'[^"]',description:'[^"]'},_t=function(e){return e.join("")},Dt='\\"',Bt={type:"literal",value:'\\"',description:'"\\\\\\""'},Ut=function(){return'"'},Pt={type:"other",description:"raw"
},Lt="{`",It={type:"literal",value:"{`",description:'"{`"'},Wt="`}",$t={type:"literal",value:"`}",description:'"`}"'},Mt=function(e){return e},Jt=function(e){return q(["raw",e.join("")])},Gt={type:"other",description:"comment"},zt="{!",qt={type:"literal",value:"{!",description:'"{!"'},Qt="!}",Ht={type:"literal",value:"!}",description:'"!}"'},Zt=function(e){return q(["comment",e.join("")])},Yt=/^[#?\^><+%:@\/~%]/,Kt={type:"class",value:"[#?^><+%:@/~%]",description:"[#?^><+%:@/~%]"},Vt="{",Xt={type:"literal",value:"{",description:'"{"'},er="}",tr={type:"literal",value:"}",description:'"}"'},rr="[",nr={type:"literal",value:"[",description:'"["'},or="]",ir={type:"literal",value:"]",description:'"]"'},ur="\n",sr={type:"literal",value:"\n",description:'"\\n"'},cr="\r\n",ar={type:"literal",value:"\r\n",description:'"\\r\\n"'},lr="\r",fr={type:"literal",value:"\r",description:'"\\r"'},pr="\u2028",dr={type:"literal",value:"\u2028",description:'"\\u2028"'},hr="\u2029",mr={type:"literal",value:"\u2029",description:'"\\u2029"'},vr=/^[\t\x0B\f \xA0\uFEFF]/,yr={type:"class",value:"[\\t\\v\\f \\u00A0\\uFEFF]",description:"[\\t\\v\\f \\u00A0\\uFEFF]"},gr=0,br=0,kr=[{line:1,column:1,seenCR:!1}],xr=0,Nr=[],Cr=0;if("startRule"in H){if(!(H.startRule in Y))throw new Error("Can't start parsing from rule \""+H.startRule+'".');K=Y[H.startRule]}if(Q=K(),Q!==Z&&gr===e.length)return Q;throw Q!==Z&&gr<e.length&&u({type:"end",description:"end of input"}),s(null,Nr,xr<e.length?e.charAt(xr):null,xr<e.length?i(xr,xr+1):i(xr,xr))}return e(t,Error),{SyntaxError:t,parse:r}}();return e.parse=t.parse,t}),function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.compile",["dust.core","dust.parse"],function(e,r){return t(r,e).compile}):"object"==typeof exports?module.exports=t(require("./parser").parse,require("./dust")):t(e.dust.parse,e.dust)}(this,function(e,t){function r(e){var t={};return g.filterNode(t,e)}function n(e,t){var r,n,o,i=[t[0]];for(r=1,n=t.length;n>r;r++)o=g.filterNode(e,t[r]),o&&i.push(o);return i}function o(e,t){var r,n,o,i,u=[t[0]];for(n=1,o=t.length;o>n;n++)i=g.filterNode(e,t[n]),i&&("buffer"===i[0]||"format"===i[0]?r?(r[0]="buffer"===i[0]?"buffer":r[0],r[1]+=i.slice(1,-2).join("")):(r=i,u.push(i)):(r=null,u.push(i)));return u}function i(e,t){return["buffer",k[t[1]],t[2],t[3]]}function u(e,t){return t}function s(){}function c(e,r){return t.config.whitespace?(r.splice(1,2,r.slice(1,-2).join("")),r):null}function a(e,r){var n,o={name:r,bodies:[],blocks:{},index:0,auto:"h"},i=t.escapeJs(r),u=r?'"'+i+'",':"",s="function(dust){",c=g.compileNode(o,e);return r&&(s+='dust.register("'+i+'",'+c+");"),s+=l(o)+f(o)+"return "+c+"}",n="("+s+"(dust));",t.config.amd?"define("+u+'["dust.core"],'+s+");":t.config.cjs?"module.exports=function(dust){var tmpl="+n+"var f="+y().toString()+";f.template=tmpl;return f}":n}function l(e){var t,r=[],n=e.blocks;for(t in n)r.push('"'+t+'":'+n[t]);return r.length?(e.blocks="ctx=ctx.shiftBlocks(blocks);","var blocks={"+r.join(",")+"};"):(e.blocks="",e.blocks)}function f(e){var t,r,n=[],o=e.bodies,i=e.blocks;for(t=0,r=o.length;r>t;t++)n[t]="function body_"+t+"(chk,ctx){"+i+"return chk"+o[t]+";}body_"+t+".__dustBody=!0;";return n.join("")}function p(e,t){var r,n,o="";for(r=1,n=t.length;n>r;r++)o+=g.compileNode(e,t[r]);return o}function d(e,r,n){return"."+(t._aliases[n]||n)+"("+g.compileNode(e,r[1])+","+g.compileNode(e,r[2])+","+g.compileNode(e,r[4])+","+g.compileNode(e,r[3])+")"}function h(e){return e.replace(x,"\\\\").replace(N,'\\"').replace(C,"\\f").replace(A,"\\n").replace(R,"\\r").replace(w,"\\t")}function m(e,r,n){var o=t.loadSource(t.compile(e));return y(o)(r,n)}function v(e,r){var n=t.loadSource(t.compile(e,r));return y(n)}function y(e){return function(r,n){var o=n?"render":"stream";return t[o](e,r,n)}}var g={},b=t.isArray;g.compile=function(t,n){try{var o=r(e(t));return a(o,n)}catch(i){if(!i.location)throw i;throw new SyntaxError(i.message+" ["+n+":"+i.location.start.line+":"+i.location.start.column+"]")}},g.filterNode=function(e,t){return g.optimizers[t[0]](e,t)},g.optimizers={body:o,buffer:u,special:i,format:c,reference:n,"#":n,"?":n,"^":n,"<":n,"+":n,"@":n,"%":n,partial:n,context:n,params:n,bodies:n,param:n,filters:u,key:u,path:u,literal:u,raw:u,comment:s,line:s,col:s},g.pragmas={esc:function(e,t,r){var n,o=e.auto;return t||(t="h"),e.auto="s"===t?"":t,n=p(e,r.block),e.auto=o,n}};var k={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};g.compileNode=function(e,t){return g.nodes[t[0]](e,t)},g.nodes={body:function(e,t){var r=e.index++,n="body_"+r;return e.bodies[r]=p(e,t),n},buffer:function(e,t){return".w("+E(t[1])+")"},format:function(e,t){return".w("+E(t[1])+")"},reference:function(e,t){return".f("+g.compileNode(e,t[1])+",ctx,"+g.compileNode(e,t[2])+")"},"#":function(e,t){return d(e,t,"section")},"?":function(e,t){return d(e,t,"exists")},"^":function(e,t){return d(e,t,"notexists")},"<":function(e,t){for(var r=t[4],n=1,o=r.length;o>n;n++){var i=r[n],u=i[1][1];if("block"===u)return e.blocks[t[1].text]=g.compileNode(e,i[2]),""}return""},"+":function(e,t){return"undefined"==typeof t[1].text&&"undefined"==typeof t[4]?".b(ctx.getBlock("+g.compileNode(e,t[1])+",chk, ctx),"+g.compileNode(e,t[2])+", {},"+g.compileNode(e,t[3])+")":".b(ctx.getBlock("+E(t[1].text)+"),"+g.compileNode(e,t[2])+","+g.compileNode(e,t[4])+","+g.compileNode(e,t[3])+")"},"@":function(e,t){return".h("+E(t[1].text)+","+g.compileNode(e,t[2])+","+g.compileNode(e,t[4])+","+g.compileNode(e,t[3])+","+g.compileNode(e,t[5])+")"},"%":function(e,t){var r,n,o,i,u,s,c,a,l,f=t[1][1];if(!g.pragmas[f])return"";for(r=t[4],n={},a=1,l=r.length;l>a;a++)s=r[a],n[s[1][1]]=s[2];for(o=t[3],i={},a=1,l=o.length;l>a;a++)c=o[a],i[c[1][1]]=c[2][1];return u=t[2][1]?t[2][1].text:null,g.pragmas[f](e,u,n,i)},partial:function(e,t){return".p("+g.compileNode(e,t[1])+",ctx,"+g.compileNode(e,t[2])+","+g.compileNode(e,t[3])+")"},context:function(e,t){return t[1]?"ctx.rebase("+g.compileNode(e,t[1])+")":"ctx"},params:function(e,t){for(var r=[],n=1,o=t.length;o>n;n++)r.push(g.compileNode(e,t[n]));return r.length?"{"+r.join(",")+"}":"{}"},bodies:function(e,t){for(var r=[],n=1,o=t.length;o>n;n++)r.push(g.compileNode(e,t[n]));return"{"+r.join(",")+"}"},param:function(e,t){return g.compileNode(e,t[1])+":"+g.compileNode(e,t[2])},filters:function(e,t){for(var r=[],n=1,o=t.length;o>n;n++){var i=t[n];r.push('"'+i+'"')}return'"'+e.auto+'"'+(r.length?",["+r.join(",")+"]":"")},key:function(e,t){return'ctx.get(["'+t[1]+'"], false)'},path:function(e,t){for(var r=t[1],n=t[2],o=[],i=0,u=n.length;u>i;i++)b(n[i])?o.push(g.compileNode(e,n[i])):o.push('"'+n[i]+'"');return"ctx.getPath("+r+", ["+o.join(",")+"])"},literal:function(e,t){return E(t[1])},raw:function(e,t){return".w("+E(t[1])+")"}};var x=/\\/g,N=/"/g,C=/\f/g,A=/\n/g,R=/\r/g,w=/\t/g,E="undefined"==typeof JSON?function(e){return'"'+h(e)+'"'}:JSON.stringify;return t.compiler=g,t.compile=t.compiler.compile,t.renderSource=m,t.compileFn=v,t.filterNode=g.filterNode,t.optimizers=g.optimizers,t.pragmas=g.pragmas,t.compileNode=g.compileNode,t.nodes=g.nodes,g}),"function"==typeof define&&define.amd&&define.amd.dust===!0&&define(["require","dust.core","dust.compile"],function(e,t){return t.onLoad=function(t,r){e([t],function(e){r(null,e)})},t}),function(e,t){"function"==typeof define&&define.amd&&define.amd.dust===!0?define(["dust.core"],t):"object"==typeof exports?module.exports=t(require("dustjs-linkedin")):t(e.dust)}(this,function(e){function t(t,r,n){n=n||"INFO",t=t?"{@"+t+"}: ":"",e.log(t+r,n)}function r(e){f[e]||(t(e,"Deprecation warning: "+e+" is deprecated and will be removed in a future version of dustjs-helpers","WARN"),t(null,"For help and a deprecation timeline, see https://github.com/linkedin/dustjs-helpers/wiki/Deprecated-Features#"+e.replace(/\W+/g,""),"WARN"),f[e]=!0)}function n(e){return e.stack.tail&&e.stack.tail.head&&"undefined"!=typeof e.stack.tail.head.__select__}function o(e){return n(e)&&e.get("__select__")}function i(e,t){var r,n=e.stack.head,o=e.rebase();e.stack&&e.stack.tail&&(o.stack=e.stack.tail);var i={isPending:!1,isResolved:!1,isDeferredComplete:!1,deferreds:[]};for(r in t)i[r]=t[r];return o.push({__select__:i}).push(n,e.stack.index,e.stack.of)}function u(e){var t,r;if(e.isDeferredPending=!0,e.deferreds.length)for(e.isDeferredComplete=!0,t=0,r=e.deferreds.length;r>t;t++)e.deferreds[t]();e.isDeferredPending=!1}function s(e,t){return"function"==typeof t?t.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):t}function c(e,t){return function(r,n,o,i){return a(r,n,o,i,e,t)}}function a(e,r,n,i,u,s){var c,a,f,p,d=n.block,h=n["else"],m=o(r)||{};if(m.isResolved&&!m.isDeferredPending)return e;if(i.hasOwnProperty("key"))a=i.key;else{if(!m.hasOwnProperty("key"))return t(u,"No key specified","WARN"),e;a=m.key}return p=i.type||m.type,a=l(r.resolve(a),p),f=l(r.resolve(i.value),p),s(a,f)?(m.isPending||(c=!0,m.isPending=!0),d&&(e=e.render(d,r)),c&&(m.isResolved=!0)):h&&(e=e.render(h,r)),e}function l(e,t){switch(t&&(t=t.toLowerCase()),t){case"number":return+e;case"string":return String(e);case"boolean":return e="false"===e?!1:e,Boolean(e);case"date":return new Date(e)}return e}var f={},p={tap:function(e,t,n){return r("tap"),n.resolve(e)},sep:function(e,t,r){var n=r.block;return t.stack.index===t.stack.of-1?e:n?n(e,t):e},first:function(e,t,r){return 0===t.stack.index?r.block(e,t):e},last:function(e,t,r){return t.stack.index===t.stack.of-1?r.block(e,t):e},contextDump:function(e,r,n,o){var i,u,c=r.resolve(o.to),a=r.resolve(o.key);switch(a){case"full":i=r.stack;break;default:i=r.stack.head}switch(u=JSON.stringify(i,s,2),c){case"console":t("contextDump",u);break;default:u=u.replace(/</g,"\\u003c"),e=e.write(u)}return e},math:function(e,r,n,s){var c,a=s.key,l=s.method,f=s.operand,p=s.round;if(!s.hasOwnProperty("key")||!s.method)return t("math","`key` or `method` was not provided","ERROR"),e;switch(a=parseFloat(r.resolve(a)),f=parseFloat(r.resolve(f)),l){case"mod":0===f&&t("math","Division by 0","ERROR"),c=a%f;break;case"add":c=a+f;break;case"subtract":c=a-f;break;case"multiply":c=a*f;break;case"divide":0===f&&t("math","Division by 0","ERROR"),c=a/f;break;case"ceil":case"floor":case"round":case"abs":c=Math[l](a);break;case"toint":c=parseInt(a,10);break;default:t("math","Method `"+l+"` is not supported","ERROR")}return"undefined"!=typeof c&&(p&&(c=Math.round(c)),n&&n.block?(r=i(r,{key:c}),e=e.render(n.block,r),u(o(r))):e=e.write(c)),e},select:function(e,r,n,s){var c=n.block,a={};return s.hasOwnProperty("key")&&(a.key=r.resolve(s.key)),s.hasOwnProperty("type")&&(a.type=s.type),c?(r=i(r,a),e=e.render(c,r),u(o(r))):t("select","Missing body block","WARN"),e},eq:c("eq",function(e,t){return e===t}),ne:c("ne",function(e,t){return e!==t}),lt:c("lt",function(e,t){return t>e}),lte:c("lte",function(e,t){return t>=e}),gt:c("gt",function(e,t){return e>t}),gte:c("gte",function(e,t){return e>=t}),any:function(e,r,n,i){var u=o(r);return u?u.isDeferredComplete?t("any","Must not be nested inside {@any} or {@none} block","ERROR"):e=e.map(function(e){u.deferreds.push(function(){u.isResolved&&(e=e.render(n.block,r)),e.end()})}):t("any","Must be used inside a {@select} block","ERROR"),e},none:function(e,r,n,i){var u=o(r);return u?u.isDeferredComplete?t("none","Must not be nested inside {@any} or {@none} block","ERROR"):e=e.map(function(e){u.deferreds.push(function(){u.isResolved||(e=e.render(n.block,r)),e.end()})}):t("none","Must be used inside a {@select} block","ERROR"),e},size:function(t,r,n,o){var i,u,s=o.key;if(s=r.resolve(o.key),s&&s!==!0)if(e.isArray(s))i=s.length;else if(!isNaN(parseFloat(s))&&isFinite(s))i=s;else if("object"==typeof s){i=0;for(u in s)s.hasOwnProperty(u)&&i++}else i=(s+"").length;else i=0;return t.write(i)}};for(var d in p)e.helpers[d]=p[d];return e});